<!DOCTYPE html>
     <html lang="en">
     <head>
         <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Real-Time Chat App</title>
         <script src="https://cdn.tailwindcss.com"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js"></script>
         <style>
             body {
                 font-family: 'Inter', sans-serif;
             }
             .chat-container {
                 max-height: 70vh;
                 overflow-y: auto;
             }
             .message {
                 max-width: 70%;
             }
             .message-sender {
                 font-size: 0.875rem;
                 color: #6b7280;
             }
             .chat-input {
                 border: 1px solid #d1d5db;
                 border-radius: 0.375rem;
                 padding: 0.5rem 1rem;
             }
             .chat-input:focus {
                 outline: none;
                 border-color: #3b82f6;
                 box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
             }
             .send-button {
                 background-color: #3b82f6;
                 transition: background-color 0.2s;
             }
             .send-button:hover {
                 background-color: #2563eb;
             }
             .chat-container::-webkit-scrollbar {
                 width: 8px;
             }
             .chat-container::-webkit-scrollbar-track {
                 background: #f1f5f9;
             }
             .chat-container::-webkit-scrollbar-thumb {
                 background: #9ca3af;
                 border-radius: 4px;
             }
         </style>
     </head>
     <body class="bg-gray-100">
         <div class="container mx-auto p-4 max-w-2xl">
             <div class="bg-white shadow-lg rounded-lg overflow-hidden">
                 <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-4">
                     <h1 class="text-2xl font-bold text-white">Real-Time Chat</h1>
                 </div>
                 <div class="chat-container p-4 flex flex-col gap-4" id="chatMessages">
                     <!-- Messages will be appended here -->
                 </div>
                 <div class="p-4 border-t border-gray-200">
                     <div class="flex gap-2">
                         <input
                             type="text"
                             id="username"
                             placeholder="Your name"
                             class="chat-input flex-1"
                         />
                         <input
                             type="text"
                             id="messageInput"
                             placeholder="Type your message..."
                             class="chat-input flex-1"
                         />
                         <button
                             id="sendButton"
                             class="send-button text-white px-4 py-2 rounded-md"
                         >
                             Send
                         </button>
                     </div>
                 </div>
             </div>
         </div>

         <script>
             // Connect to Socket.IO server dynamically
             const socket = io(window.location.origin);

             // DOM elements
             const chatMessages = document.getElementById('chatMessages');
             const messageInput = document.getElementById('messageInput');
             const usernameInput = document.getElementById('username');
             const sendButton = document.getElementById('sendButton');

             // Handle sending messages
             function sendMessage() {
                 const message = messageInput.value.trim();
                 const username = usernameInput.value.trim() || 'Anonymous';
                 if (message) {
                     socket.emit('chatMessage', { username, message });
                     messageInput.value = '';
                 }
             }

             // Handle receiving single message
             socket.on('message', ({ username, message, timestamp }) => {
                 appendMessage({ username, message, timestamp });
             });

             // Handle loading stored messages
             socket.on('loadMessages', (messages) => {
                 messages.forEach(({ username, message, timestamp }) => {
                     appendMessage({ username, message, timestamp });
                 });
             });

             // Handle errors
             socket.on('error', ({ message }) => {
                 alert(message); // Simple error handling; enhance for production
             });

             // Append message to chat
             function appendMessage({ username, message, timestamp }) {
                 const messageElement = document.createElement('div');
                 const isOwnMessage = socket.id === username;
                 messageElement.className = `message p-3 rounded-lg ${
                     isOwnMessage ? 'bg-blue-100 ml-auto' : 'bg-gray-100 mr-auto'
                 }`;
                 messageElement.innerHTML = `
                     <div class="message-sender font-semibold">${username}</div>
                     <div>${message}</div>
                     <div class="text-xs text-gray-500 mt-1">${new Date(timestamp).toLocaleTimeString()}</div>
                 `;
                 chatMessages.appendChild(messageElement);
                 chatMessages.scrollTop = chatMessages.scrollHeight;
             }

             // Event listeners
             sendButton.addEventListener('click', sendMessage);
             messageInput.addEventListener('keypress', (e) => {
                 if (e.key === 'Enter') sendMessage();
             });

             // Auto-scroll to bottom on load
             chatMessages.scrollTop = chatMessages.scrollHeight;
         </script>
     </body>
     </html>